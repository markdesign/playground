<!DOCTYPE html>
<html>
    <head>
        <title>Microsoft Cognitive Services Speech SDK JavaScript Quickstart</title>
        <meta charset="utf-8" />
        <!-- <speechsdkref> -->
        <!-- Speech SDK reference sdk. -->
        <script src="./script.js"></script>
        <!-- </speechsdkref> -->
    </head>
    <body style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 13px">
        <!-- <uidiv> -->
        <div id="warning">
            <h1 style="font-weight: 500">
                Speech Recognition Speech SDK not found (microsoft.cognitiveservices.speech.sdk.bundle.js missing).
            </h1>
        </div>

        <div id="content" style="display: none">
            <table width="100%">
                <tr>
                    <td></td>
                    <td>
                        <h1 style="font-weight: 500">Microsoft Cognitive Services Speech SDK JavaScript Quickstart</h1>
                    </td>
                </tr>
                <tr>
                    <td align="right">
                        <a
                            href="https://docs.microsoft.com/azure/cognitive-services/speech-service/get-started"
                            target="_blank"
                            >Subscription</a
                        >:
                    </td>
                    <td><input id="subscriptionKey" type="text" size="40" value="b6c3e0661b4b4367b2be97b4900a8323" /></td>
                </tr>
                <tr>
                    <td align="right">Region</td>
                    <td><input id="serviceRegion" type="text" size="40" value="westus2" /></td>
                </tr>
                <tr>
                    <td></td>
                    <td><button id="startRecognizeOnceAsyncButton">Start recognition</button></td>
                </tr>
                <tr>
                    <td align="right" valign="top">Results</td>
                    <td>
                        <textarea id="phraseDiv" style="display: inline-block; width: 500px; height: 200px"></textarea>
                    </td>
                </tr>
            </table>
        </div>
        <!-- </uidiv> -->

        <!-- <quickstartcode> -->
        <!-- Speech SDK USAGE -->
        <script>
            // status fields and start button in UI
            var phraseDiv;
            var startRecognizeOnceAsyncButton;

            // subscription key and region for speech services.
            var subscriptionKey, serviceRegion;
            var SpeechSDK;
            var recognizer;

            document.addEventListener("DOMContentLoaded", function () {
                startRecognizeOnceAsyncButton = document.getElementById("startRecognizeOnceAsyncButton");
                subscriptionKey = document.getElementById("subscriptionKey");
                serviceRegion = document.getElementById("serviceRegion");
                phraseDiv = document.getElementById("phraseDiv");

                startRecognizeOnceAsyncButton.addEventListener("click", function () {
                    if (!subscriptionKey.value || !serviceRegion.value) {
                        alert("Please enter your subscription key and service region.");
                        return;
                    }

                    var speechConfig = SpeechSDK.SpeechConfig.fromSubscription(subscriptionKey.value, serviceRegion.value);
                    var audioConfig = SpeechSDK.AudioConfig.fromDefaultMicrophoneInput();
                    recognizer = new SpeechSDK.SpeechRecognizer(speechConfig, audioConfig);

                    recognizer.recognizeOnceAsync(
                        function (result) {
                            phraseDiv.value += result.text;
                            recognizer.close();
                            recognizer = undefined;
                        },
                        function (err) {
                            console.error(err);
                            recognizer.close();
                            recognizer = undefined;
                        }
                    );
                });

                console.log("Speech SDK loaded.", window.SpeechSDK);
                if (!!window.SpeechSDK) {
                    console.log("1");
                    SpeechSDK = window.SpeechSDK;
                    startRecognizeOnceAsyncButton.disabled = false;

                    document.getElementById("content").style.display = "block";
                    document.getElementById("warning").style.display = "none";
                }
            });
        </script>
        <!-- </quickstartcode> -->
    </body>
</html>